namespace utils

readLines : Text -> {IO, Exception} [Text]
readLines fileName =
    readLines0 f acc =
        use List :+
        if isEOF f then acc
        else readLines0 f (acc :+ getLine f)
    f = open (FilePath fileName) Read
    readLines0 f []

toInts : [Text] -> [Int]
toInts lst = map (t -> t |> fromText |> getOrBug "expected int") lst

sumInts : [Int] -> Int
sumInts lst = 
    List.foldLeft (x acc -> x + acc) +0 lst
